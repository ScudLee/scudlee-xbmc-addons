<scraperfunctions>

  <NfoUrl dest="3">         
    <RegExp input="$$1" output="&lt;url gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="3">
      <expression>aid=(\d+)</expression>
    </RegExp>
  </NfoUrl>

  <GetSearchResults clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;results&gt;\1&lt;/results&gt;" dest="4">
      <RegExp conditional="Google" input="$$4" output="\1" dest="4">
        <RegExp conditional="Google" input="$$1" output="&lt;chain function=&quot;GetGoogleResultsByID&quot;&gt;\1&lt;/chain&gt;" dest="4">
          <expression clear="yes" repeat="yes">(?i)&lt;cite&gt;anidb\.net/perl-bin/animedb\.pl\?show=anime&amp;amp;aid=(\d+)&lt;/cite&gt;</expression>
        </RegExp>
        <RegExp conditional="Google" input="$$1" output="&lt;chain function=&quot;GetGoogleResultsByID&quot;&gt;\1&lt;/chain&gt;" dest="4+">
          <expression repeat="yes">(?i)&lt;cite&gt;anidb\.net/a(\d+)&lt;/cite&gt;</expression>
        </RegExp>
        <expression noclean="1"/>
      </RegExp> 
      <RegExp conditional="!Google" input="$$5" output="\1" dest="4">
        <RegExp input="$$18" output="\1[^&lt;]*" dest="6">
          <expression clear="yes" repeat="yes">(?i)([a-z0-9]+)(?:%[a-f0-9]{2}|[!.()-])*</expression>
        </RegExp>
        <RegExp input="$$1" output="&lt;entity&gt;&lt;title&gt;Anidb Search : A\1 ~ \2&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;&lt;id&gt;\1&lt;/id&gt;&lt;year&gt;\3&lt;/year&gt;&lt;/entity&gt;" dest="5">
          <expression clear="yes" repeat="yes" trim="2">&lt;anime aid=&quot;(\d+)&quot;&gt;(?:[^&lt;]*&lt;title[^&lt;]+&lt;/title&gt;)*[^&lt;]*&lt;title\s+type=&quot;main&quot;[^&gt;]*&gt;([^&lt;]*$$6?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
        </RegExp>
        <RegExp conditional="OfficialName" input="$$1" output="&lt;entity&gt;&lt;title&gt;Anidb Search : A\1 ~ \2&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;&lt;id&gt;\1&lt;/id&gt;&lt;year&gt;\3&lt;/year&gt;&lt;/entity&gt;" dest="5+">
          <expression repeat="yes" trim="2">&lt;anime aid=&quot;(\d+)&quot;&gt;(?:[^&lt;]*&lt;title[^&lt;]+&lt;/title&gt;)*[^&lt;]*&lt;title\s+type=&quot;official&quot;\s+xml:lang=&quot;$INFO[OfficialLanguage]&quot;[^&gt;]*&gt;([^&lt;]*$$6?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
        </RegExp>
        <RegExp conditional="!OfficialName" input="$$1" output="&lt;entity&gt;&lt;title&gt;Anidb Search : A\1 ~ \2&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;&lt;id&gt;\1&lt;/id&gt;&lt;year&gt;\3&lt;/year&gt;&lt;/entity&gt;" dest="5+">
          <expression repeat="yes" trim="2">&lt;anime aid=&quot;(\d+)&quot;&gt;(?:[^&lt;]*&lt;title[^&lt;]+&lt;/title&gt;)*[^&lt;]*&lt;title\s+type=&quot;official&quot;\s+xml:lang=&quot;en&quot;[^&gt;]*&gt;([^&lt;]*$$6?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
        </RegExp>
        <RegExp input="$$1" output="&lt;entity&gt;&lt;title&gt;Anidb Search : A\1 ~ \2&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;&lt;id&gt;\1&lt;/id&gt;&lt;year&gt;\3&lt;/year&gt;&lt;/entity&gt;" dest="5+">
          <expression repeat="yes" trim="2">&lt;anime aid=&quot;(\d+)&quot;&gt;(?:[^&lt;]*&lt;title[^&lt;]+&lt;/title&gt;)*[^&lt;]*&lt;title\s+type=&quot;syn&quot;\s+xml:lang=&quot;x-jat&quot;[^&gt;]*&gt;([^&lt;]*$$6?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
        </RegExp>
        <RegExp input="$$5" output="\1" dest="5">
          <RegExp input="$$5" output="'\1" dest="5">
            <expression clear="yes" repeat="yes" noclean="1">`?([^`]*)</expression>
          </RegExp>
          <expression noclean="1">'(.*)'</expression>
        </RegExp>
        <expression noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetSearchResults>

  <GetGoogleResultsByID clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;results&gt;\1&lt;/results&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression/>
      </RegExp>
      <RegExp input="" output="&lt;url function=&quot;ParseGoogleResults&quot; gzip=&quot;yes&quot; cache=&quot;animetitles.xml&quot;&gt;$INFO[AnimeTitlesUrl]&lt;/url&gt;" dest="4">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetGoogleResultsByID>
  <ParseGoogleResults clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;results&gt;\1&lt;/results&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="20">
        <expression noclean="1" clear="yes">(?i)&lt;anime\s+aid=&quot;$$5&quot;&gt;(.*?)&lt;/anime&gt;</expression>
      </RegExp>
      <RegExp input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4">
        <expression clear="yes" repeat="yes" trim="1">(?i)&lt;title\s+type=&quot;main&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp conditional="OfficialName" input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4+">
        <expression repeat="yes" trim="1">(?i)&lt;title\s+type=&quot;official&quot;\s+xml:lang=&quot;$INFO[OfficialLanguage]&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp conditional="!OfficialName" input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4+">
        <expression repeat="yes" trim="1">(?i)&lt;title\s+type=&quot;official&quot;\s+xml:lang=&quot;en&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4+">
        <expression repeat="yes" trim="1">(?i)&lt;title\s+type=&quot;syn&quot;\s+xml:lang=&quot;x-jat&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$4" output="\1" dest="4">
        <RegExp input="$$4" output="'\1" dest="4">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]*)</expression>
        </RegExp>
        <expression noclean="1">'(.*)'</expression>
      </RegExp>
      <RegExp input="$$20" output="&lt;url function=&quot;ParseGoogleResultsBackup&quot; gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;" dest="4">
        <expression>^$</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseGoogleResults>
  <ParseGoogleResultsBackup clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;results&gt;\1&lt;/results&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="20">
        <expression noclean="1" clear="yes">(?i)&lt;titles&gt;(.*?)&lt;/titles&gt;</expression>
      </RegExp>
      <RegExp input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4">
        <expression clear="yes" repeat="yes" trim="1">(?i)&lt;title[^&gt;]*?type=&quot;main&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp conditional="OfficialName" input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4+">
        <expression repeat="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;$INFO[OfficialLanguage]&quot;\s+type=&quot;official&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp conditional="!OfficialName" input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4+">
        <expression repeat="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;en&quot;\s+type=&quot;official&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$20" output="&lt;entity&gt;&lt;title&gt;Google Search : A$$5 ~ \1&lt;/title&gt;&lt;url gzip=&quot;yes&quot; cache=&quot;$$5.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=$$5&lt;/url&gt;&lt;id&gt;$$5&lt;/id&gt;&lt;year&gt;\2&lt;/year&gt;&lt;/entity&gt;" dest="4+">
        <expression repeat="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;x-jat&quot;\s+type=&quot;syn&quot;[^&gt;]*&gt;([^&lt;]*?(?:\(((?:19|20)\d\d)\))?)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$4" output="\1" dest="4">
        <RegExp input="$$4" output="'\1" dest="4">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]*)</expression>
        </RegExp>
        <expression noclean="1">'(.*)'</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseGoogleResultsBackup>

  <GetPersonalAnimeMapping clearbuffers="no" dest="3">
    <RegExp input="" output="&lt;details&gt;&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="\1" dest="2">
        <expression noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetPersonalAnimeMapping>

  <LoadAnimeMapping clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$2$$1" output="\1" dest="8">
        <expression clear="yes" noclean="1">(?i)(&lt;anime\s+anidbid=&quot;$$20&quot;.*?&lt;/anime&gt;)</expression>
      </RegExp>
      <RegExp input="$$8" output="\1" dest="19">
        <expression clear="yes">(?i)tvdbid=&quot;([^&quot;]*)&quot;</expression>
      </RegExp>
      <RegExp input="$$8" output="\1" dest="18">
        <expression clear="yes" noclean="1">(?i)(&lt;supplemental-info\s+replace=&quot;(?:true|yes)&quot;&gt;.*?&lt;/supplemental-info&gt;)</expression>
      </RegExp>
      <RegExp input="$$8" output="\1" dest="17">
        <expression clear="yes" noclean="1">(?i)(&lt;supplemental-info(?!\s+replace=&quot;(?:true|yes)&quot;)[^&gt;]*&gt;.*?&lt;/supplemental-info&gt;)</expression>
      </RegExp>
      <RegExp input="-1" output="\1" dest="11">
        <expression/>
      </RegExp>
      <RegExp input="$$8" output="\1" dest="11">
        <expression>(?i)defaulttvdbseason=&quot;([^&quot;]*)&quot;</expression>
      </RegExp>
      <RegExp input="$$8" output="\1" dest="12">
        <expression clear="yes">(?i)imdbid=&quot;([^&quot;]*)&quot;</expression>
      </RegExp>
      <RegExp input="$$8" output="\1" dest="12">
        <expression>(?i)tmdbid=&quot;([^&quot;]*)&quot;</expression>
      </RegExp>
      <RegExp input="$$12$$19" output="&lt;url function=&quot;PrepareTVDBSearch&quot; cache=&quot;$$20.xml&quot;&gt;&amp;&lt;/url&gt;" dest="8">
        <expression clear="yes">^$</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </LoadAnimeMapping>
  <PrepareTVDBSearch clearbuffers="no" dest="4">
    <RegExp input="$$9" output="&lt;details&gt;&lt;url function=&quot;CheckTVDBResults&quot; cache=&quot;tvdb-s$$20-\1.xml&quot;&gt;http://www.thetvdb.com/api/GetSeries.php?seriesname=\1&lt;/url&gt;&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression clear="yes" trim="1">(?i)&lt;title.*?type=&quot;main&quot;&gt;([^&lt;]+)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$1" output="\1" dest="6">
        <expression clear="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;en&quot;\s+type=&quot;official&quot;&gt;((?!$$5&lt;)[^&lt;]+)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$1" output="\1" dest="7">
        <expression clear="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;x-jat&quot;\s+type=&quot;synonym&quot;&gt;((?!$$5&lt;|$$6&lt;)[^&lt;]+)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$1" output="\1" dest="8">
        <expression clear="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;en&quot;\s+type=&quot;synonym&quot;&gt;((?!$$5&lt;|$$6&lt;|$$7&lt;)[^&lt;]+)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp input="$$9" output="\1" dest="9">
        <RegExp input="$$5" output="'\1" dest="9">
          <expression clear="yes" repeat="yes">`?([^`]+)</expression>
        </RegExp>
        <expression>'(.*)</expression>
      </RegExp>
      <RegExp input="$$9" output="\1%20" dest="9">
        <expression repeat="yes">([a-zA-Z0-9'!-.]+)</expression>
      </RegExp>
      <RegExp input="$$9" output="\1" dest="9">
        <expression noclean="1">(.+)%20</expression>
      </RegExp>
      <RegExp input="$$10" output="\1" dest="10">
        <RegExp input="$$6" output="'\1" dest="10">
          <expression clear="yes" repeat="yes">`?([^`]+)</expression>
        </RegExp>
        <expression>'(.*)</expression>
      </RegExp>
      <RegExp input="$$10" output="\1%20" dest="10">
        <expression repeat="yes">([a-zA-Z0-9'!-.]+)</expression>
      </RegExp>
      <RegExp input="$$10" output="&lt;title&gt;\1&lt;/title&gt;" dest="16">
        <expression clear="yes" noclean="1">(.+)%20</expression>
      </RegExp>
      <RegExp input="$$10" output="\1" dest="10">
        <RegExp input="$$7" output="'\1" dest="10">
          <expression clear="yes" repeat="yes">`?([^`]+)</expression>
        </RegExp>
        <expression>'(.*)</expression>
      </RegExp>
      <RegExp input="$$10" output="\1%20" dest="10">
        <expression repeat="yes">([a-zA-Z0-9'!-.]+)</expression>
      </RegExp>
      <RegExp input="$$10" output="&lt;title&gt;\1&lt;/title&gt;" dest="10">
        <expression clear="yes" noclean="1">(.+)%20</expression>
      </RegExp>
      <RegExp input="$$10" output="\1" dest="16+">
        <expression noclean="1"/>
      </RegExp>
      <RegExp input="$$10" output="\1" dest="10">
        <RegExp input="$$8" output="'\1" dest="10">
          <expression clear="yes" repeat="yes">`?([^`]+)</expression>
        </RegExp>
        <expression>'(.*)</expression>
      </RegExp>
      <RegExp input="$$10" output="\1%20" dest="10">
        <expression repeat="yes">([a-zA-Z0-9'!-.]+)</expression>
      </RegExp>
      <RegExp input="$$10" output="&lt;title&gt;\1&lt;/title&gt;" dest="10">
        <expression clear="yes" noclean="1">(.+)%20</expression>
      </RegExp>
      <RegExp input="$$10" output="\1" dest="16+">
        <expression noclean="1"/>
      </RegExp>
      <RegExp conditional="Prequels" input="$$10" output="\1" dest="15">
        <RegExp input="$$1" output="\1" dest="10">
          <expression clear="yes">(?i)&lt;anime id=&quot;(\d+)&quot; type=&quot;$INFO[AlternativePrequelLinkType]&quot;&gt;</expression>
        </RegExp>
        <RegExp input="$$1" output="\1" dest="10">
          <expression>(?i)&lt;anime id=&quot;(\d+)&quot; type=&quot;Prequel&quot;&gt;</expression>
        </RegExp>
        <expression clear="yes">(\d+)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>              
  </PrepareTVDBSearch>
  <CheckTVDBResults clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$20" output="&lt;chain function=&quot;TVDBSearchLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="4">
        <expression clear="yes"/>
      </RegExp>
      <RegExp input="$$1" output="&lt;url function=&quot;CheckForFanart&quot; cache=&quot;tvdb-$$20.xml&quot;&gt;http://www.thetvdb.com/api/1D62F2F90030C444/series/\1/all/en.zip&lt;/url&gt;" dest="4">
        <expression>(?i)&lt;seriesid&gt;(\d+)&lt;/seriesid&gt;</expression>
      </RegExp>
      <RegExp input="$$1" output="\1" dest="19">
        <expression>(?i)&lt;seriesid&gt;(\d+)&lt;/seriesid&gt;</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </CheckTVDBResults>
  <TVDBSearchLoop clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$8" output="&lt;url function=&quot;CheckTVDBResults&quot; cache=&quot;tvdb-s$$20-\1.xml&quot;&gt;http://www.thetvdb.com/api/GetSeries.php?seriesname=\1&lt;/url&gt;" dest="5">
        <RegExp input="$$16" output="\1" dest="8">
          <expression clear="yes" noclean="1">(?i)&lt;title&gt;([^&lt;]+)&lt;/title&gt;</expression>
        </RegExp>
        <expression clear="yes" noclean="1">(.+)</expression>
      </RegExp>
      <RegExp conditional="Prequels" input="$$15" output="&lt;url function=&quot;PrepareTVDBSearch&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="6">
        <expression clear="yes">(\d+)</expression>
      </RegExp>
      <RegExp input="$$5$$6" output="\1" dest="4">
        <expression clear="yes" noclean="1">(?i)(&lt;url.*?&lt;/url&gt;)</expression>
      </RegExp>
      <RegExp input="$$16-$$4" output="\1" dest="16">
        <expression noclean="1">(?i)&lt;title&gt;[^&lt;]+&lt;/title&gt;((?:&lt;title&gt;[^&lt;]+&lt;/title&gt;)*)-\Q$$5\E</expression>
      </RegExp>
      <RegExp input="$$15-$$4" output="\1" dest="20">
        <expression>(\d+)-\Q$$6\E</expression>
      </RegExp>
      <RegExp input="$$4" output="\1" dest="15">
        <expression>()\Q$$6\E</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </TVDBSearchLoop>
  <CheckForFanart clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="true" dest="4">
        <expression clear="yes">(?i)&lt;bannertype&gt;fanart&lt;/bannertype&gt;</expression>
      </RegExp>
      <RegExp conditional="NoFanartContinue" input="$$4" output="&lt;chain function=&quot;TVDBSearchLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="4">
        <expression clear="yes">^$</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </CheckForFanart>

  <GetIDByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$INFO[IdFrom]" output="&lt;id&gt;$$1&lt;/id&gt;" dest="8">
        <expression clear="yes">AniDB\.net</expression>
      </RegExp>
      <RegExp input="$INFO[IdFrom]-$$19" output="&lt;id&gt;\1&lt;/id&gt;" dest="8">
        <expression>TheTVDB\.com-(\d+)</expression>
      </RegExp>
      <RegExp input="$INFO[IdFrom]-$$12" output="&lt;id&gt;\1&lt;/id&gt;" dest="8">
        <expression>IMDB\.com-((?:tt)\d+)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetIDByIDChain> 

  <GetTitleByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseTitle&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetTitleByIDChain> 
  <ParseTitle clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="&lt;title&gt;\1&lt;/title&gt;" dest="6">
        <expression clear="yes" trim="1">(?i)&lt;title.*?type=&quot;main&quot;&gt;([^&lt;]+)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp conditional="OfficialName" input="$$1" output="\1" dest="5">
        <expression clear="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;$INFO[OfficialLanguage]&quot;\s+type=&quot;official&quot;&gt;([^&lt;]+)&lt;/title&gt;</expression> 
      </RegExp>
      <RegExp conditional="OfficialName" input="$$5" output="&lt;title&gt;\1&lt;/title&gt;" dest="6">
        <expression noclean="1">(.+)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1">(?i)(&lt;title&gt;.*?&lt;/title&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8">
        <RegExp input="$$6" output="'\1" dest="6">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
        </RegExp>
        <expression clear="yes" noclean="1">'(.*)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseTitle>

  <GetOriginalTitleByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseOriginalTitle&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetOriginalTitleByIDChain> 
  <ParseOriginalTitle clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp conditional="!OfficialName" input="$$1" output="&lt;originaltitle&gt;\1&lt;/originaltitle&gt;" dest="6">
        <expression clear="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;en&quot;\s+type=&quot;official&quot;&gt;([^&lt;]+)&lt;/title&gt;</expression>
      </RegExp>
      <RegExp conditional="OfficialName" input="$$1" output="&lt;originaltitle&gt;\1&lt;/originaltitle&gt;" dest="6">
        <expression clear="yes" trim="1">(?i)&lt;title\s+xml:lang=&quot;$INFO[OfficialLanguage]&quot;\s+type=&quot;official&quot;&gt;([^&lt;]+)&lt;/title&gt;</expression> 
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1">(?i)(&lt;originaltitle&gt;.*?&lt;/originaltitle&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8">
        <RegExp input="$$6" output="'\1" dest="6">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
        </RegExp>
        <expression clear="yes" noclean="1">'(.*)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseOriginalTitle>

  <GetStartDateByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseStartDate&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetStartDateByIDChain> 
  <ParseStartDate clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="&lt;year&gt;\1&lt;/year&gt;" dest="6">
        <expression clear="yes">(?i)&lt;startdate&gt;(\d{4})-?</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1">(?i)(&lt;year&gt;.*?&lt;/year&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8">         
        <expression clear="yes" noclean="1"/>
      </RegExp>
      <RegExp input="$$1" output="&lt;premiered&gt;\1&lt;/premiered&gt;" dest="6">
        <expression clear="yes">&lt;startdate&gt;([^&lt;]+)&lt;/startdate&gt;</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1">(?i)(&lt;premiered&gt;.*?&lt;/premiered&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8+">
        <expression noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseStartDate>

  <GetTagsByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseTags&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetTagsByIDChain> 
  <ParseTags clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp conditional="AddTagsToAll" input="$INFO[TagList]" output="&lt;tag&gt;\1&lt;/tag&gt;" dest="6">
        <expression clear="yes" repeat="yes">([^;]+);?</expression>
      </RegExp>
      <RegExp conditional="AniDBTags" input="$$5" output="\1" dest="6+">
        <RegExp input="0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|" output="(?!(?:\1)&quot;)" dest="7">
          <expression clear="yes">(.*)\|$INFO[MinApproval]\|</expression>
        </RegExp>
        <RegExp input="$$1" output="&lt;tag&gt;\1&lt;/tag&gt;" dest="5">
          <expression clear="yes" repeat="yes">&lt;tag[^&gt;]*approval=&quot;$$7\d+&quot;[^&gt;]*localspoiler=&quot;(?:false|$INFO[IncludeSpoilerTags])&quot;[^&gt;]*&gt;[^&lt;]*&lt;name&gt;([^&lt;]+)&lt;/name&gt;</expression>
        </RegExp>
        <expression noclean="1"/>
      </RegExp>
      <RegExp conditional="SourceTags" input="$$5" output="\1" dest="6+">
        <RegExp input="$$1" output="&lt;tag&gt;$INFO[SourcePrefix]\1&lt;/tag&gt;" dest="5">
          <expression clear="yes" repeat="yes">&lt;category[^&gt;]*parentid=&quot;(?:268|269|273)&quot;[^&gt;]*&gt;[^&lt;]*&lt;name&gt;([^&lt;]*)&lt;/name&gt;</expression>
        </RegExp>
        <expression noclean="1"/>
      </RegExp>
      <RegExp conditional="LocationTags" input="$$5" output="\1" dest="6+">
        <RegExp input="$$1" output="&lt;tag&gt;$INFO[LocationPrefix]\1&lt;/tag&gt;" dest="5">
          <expression clear="yes" repeat="yes">&lt;category[^&gt;]*parentid=&quot;(?:7|19|22|23|24|116|128|197|279|280|289|291|514|519|525|526)&quot;[^&gt;]*&gt;[^&lt;]*&lt;name&gt;([^&lt;]*)&lt;/name&gt;</expression>
        </RegExp>
        <expression noclean="1"/>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8">
        <RegExp input="$$6" output="'\1" dest="6">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
        </RegExp>
        <expression clear="yes" noclean="1">'(.*)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseTags>

  <GetRatingByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseRating&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetRatingByIDChain> 
  <ParseRating clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$INFO[RatingType]" output="$$5" dest="6">
        <RegExp input="$$1" output="\1;\2" dest="5">
          <expression clear="yes">(?i)&lt;temporary.+?count=&quot;(\d+)&quot;[^&gt;]*&gt;([^&lt;]+)&lt;/temporary&gt;</expression>
        </RegExp>
        <expression>Average</expression>
      </RegExp>      
      <RegExp input="$INFO[RatingType]" output="$$5" dest="6">
        <RegExp input="$$1" output="\1;\2" dest="5">
          <expression clear="yes">(?i)&lt;permanent.+?count=&quot;(\d+)&quot;[^&gt;]*&gt;([^&lt;]+)&lt;/permanent&gt;</expression>
        </RegExp>
        <expression>Weighted</expression>
      </RegExp>      
      <RegExp input="$$6" output="&lt;votes&gt;\1&lt;/votes&gt;" dest="8">
        <expression clear="yes">(\d+);.+</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="8">
        <expression noclean="1">(?i)(&lt;votes&gt;.*?&lt;/votes&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="&lt;rating&gt;\1&lt;/rating&gt;" dest="7">
        <expression clear="yes">\d+;(.+)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="7">
        <expression noclean="1">(?i)(&lt;rating&gt;.*?&lt;/rating&gt;)</expression>
      </RegExp>
      <RegExp input="$$7" output="\1" dest="8+">
        <expression noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseRating>

  <GetGenresByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseGenres&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetGenresByIDChain> 
  <ParseGenres clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression clear="yes" noclean="1">(?i)&lt;categories&gt;(.*?)&lt;/categories&gt;</expression>
      </RegExp>
      <!-- Sort categories by weight -->
      <RegExp input="$$5" output="\1" dest="7">
        <expression clear="yes" noclean="1" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;600&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <RegExp input="$$5" output="\1" dest="7+">
        <expression noclean="1" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;500&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <RegExp input="$$5" output="\1" dest="7+">
        <expression noclean="1" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;400&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <RegExp input="$$5" output="\1" dest="7+">
        <expression noclean="1" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;300&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <RegExp input="$$5" output="\1" dest="7+">
        <expression noclean="1" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;200&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <RegExp input="$$5" output="\1" dest="7+">
        <expression noclean="1" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;100&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <RegExp input="000|100|200|300|400|500|600|" output="(?!(?:\1)&quot;)" dest="9">
        <expression clear="yes">(.*)\|$INFO[MinGenreWeight]\|</expression>
      </RegExp>
      <!-- Ignore categories below minimum weight -->
      <RegExp input="$$7" output="\1" dest="7">
        <expression noclean="1" clear="yes" repeat="yes">(?i)(&lt;category[^&gt;]*weight=&quot;$$9\d+&quot;&gt;[^&lt;]*&lt;name&gt;[^&lt;]+&lt;/name&gt;)</expression>
      </RegExp>
      <!-- Always ignore these category ids -->
      <RegExp input="" output="60|128|129|185|242|255|289" dest="9">
        <expression/>
      </RegExp>
      <!-- Ignore "Magic" if "Super Power" or "Mahou Shoujo" is present -->
      <RegExp input="$$7" output="|175" dest="9+">
        <expression>(?i) id="(18|247)"</expression>
      </RegExp>
      <!-- Ignore "Super Power" if "Mahou Shoujo" is present -->
      <RegExp input="$$7" output="|18" dest="9+">
        <expression>(?i) id="247"</expression>
      </RegExp>
      <!-- Ignore "Fantasy World" if "Fantasy" is present -->
      <RegExp input="$$7" output="|291" dest="9+">
        <expression>(?i) id="15"</expression>
      </RegExp>
      <!-- Ignore "Fantasy" if "Contemporary Fantasy" or "Dark Fantasy" is present -->
      <RegExp input="$$7" output="|15" dest="9+">
        <expression>(?i) id="(183|265)"</expression>
      </RegExp>
      <!-- Ignore "Catgirls" if "Juujin" is present -->
      <RegExp input="$$7" output="|202" dest="9+">
        <expression>(?i) id="201"</expression>
      </RegExp>
      <!-- Ignore "Genetic Modification" and "Cyborgs" if "Human Enhancement" is present -->
      <RegExp input="$$7" output="|120|329" dest="9+">
        <expression>(?i) id="328"</expression>
      </RegExp>
      <!-- Ignore "Transforming Robots" if "Piloted Robots" is present -->
      <RegExp input="$$7" output="|149" dest="9+">
        <expression>(?i) id="118"</expression>
      </RegExp>
      <!-- Ignore "Piloted Robots" if "Mecha" is present -->
      <RegExp input="$$7" output="|118" dest="9+">
        <expression>(?i) id="13"</expression>
      </RegExp>
      <!-- Ignore "Ninjas" if "Martial Arts" is present -->
      <RegExp input="$$7" output="|29" dest="9+">
        <expression>(?i) id="20"</expression>
      </RegExp>
      <!-- Ignore "Cops" if "Special Squads" is present -->
      <RegExp input="$$7" output="|177" dest="9+">
        <expression>(?i) id="203"</expression>
      </RegExp>
      <!-- Ignore "Space" if "Space Travel" is present -->
      <RegExp input="$$7" output="|19" dest="9+">
        <expression>(?i) id="174"</expression>
      </RegExp>
      <RegExp input="$$7" output="&lt;genre&gt;\1&lt;/genre&gt;" dest="6">
        <expression noclean="1" clear="yes" repeat="yes">(?i)&lt;category[^&gt;]*id=&quot;(?!(?:$$9)&quot;)\d+&quot;[^&gt;]*parentid=&quot;(?!(?:6|22|23|24|50|83|116|153|197|216|268|269|279|280|282|289|514)&quot;)\d+&quot;[^&gt;]*&gt;[^&lt;]*&lt;name&gt;([^&lt;]+)&lt;/name&gt;</expression>
      </RegExp>
      <RegExp input="$$17" output="\1" dest="6+">
        <expression noclean="1" repeat="yes">(?i)(&lt;genre&gt;.*?&lt;/genre&gt;)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1" repeat="yes">(?i)(&lt;genre&gt;.*?&lt;/genre&gt;)</expression>
      </RegExp>
      <!-- Only take up to the specified number of genres -->
      <RegExp input="$$6" output="\1" dest="8">
        <expression clear="yes" noclean="1">(?i)((?:&lt;genre&gt;[^&lt;]+&lt;/genre&gt;){0,$INFO[GenreCount]})</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseGenres>

  <GetPlotByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParsePlot&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetPlotByIDChain> 
  <ParsePlot clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="6">
        <expression clear="yes">(?&lt;!/charactertype&gt;\n)&lt;description[^&gt;]*&gt;([^&lt;]*?)&lt;/description&gt;[^&lt;]*&lt;[^/]</expression>
      </RegExp>
      <!-- Plot filtering -->
      <RegExp input="$$6" output="\1 " dest="6">
        <expression repeat="yes" noclean="1">([^\t]*)\t?</expression>
      </RegExp>
      <RegExp input="$$6" output="\1\2" dest="6">
        <expression repeat="yes" noclean="1,2">([^\s]*)(?:(\s)\2*)?</expression>
      </RegExp>     
      <RegExp input="$$6" output="\1\2" dest="6">
        <expression repeat="yes" noclean="1,2">([^\r\n]*)(?:(\r?\n)[ \t\r\n]*)?</expression>
      </RegExp>     
      <RegExp input="$$6" output="\1" dest="6">
        <expression noclean="1">(?:\*\s?)?(.*)</expression>
      </RegExp>
      <RegExp input="$$6 http://anidb.net/a666 []" output="\1\2" dest="6">
        <expression repeat="yes" noclean="1,2">(?i)(.*?)http://anidb.net/[a-z]+[0-9]+\s\[([^]]*)]</expression>
      </RegExp>
      <RegExp input="$$6 [url=][/url]" output="\1\2" dest="6">
        <expression repeat="yes" noclean="1,2">(?i)(.*?)\[url=[^]]*]([^[]*)\[/url]</expression>
      </RegExp>
      <RegExp input="(?:quote from|quote|taken from|from the|from|source|by)" output="\1" dest="7">
        <expression noclean="1"/>
      </RegExp>
      <RegExp input="(?:www)?\.?(?:ann|animenewsnetwork|animenfo|animnfo|myanimelist|animeondvd|animeacademy|mangaupdates|manga-updates|wikipedia|wiki)(\.:)?(?:com|net|org)?:?" output="\1" dest="9">
        <expression noclean="1"/>
      </RegExp>
      <RegExp input="$$6 [source]" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)(?:(\[)|(\()|\*)(?(2)[^]]|(?(3)[^)]|[^*]))*$$7(?(2)[^]]|(?(3)[^)]|[^*]))*(?(2)\]|(?(3)\)|\*))</expression>
      </RegExp>
      <RegExp input="$$6 [http://]" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)(?:(\[)|(\()|\*)\s*http://(?(2)[^]]|(?(3)[^)]|[^*]))*(?(2)\]|(?(3)\)|\*))</expression>
      </RegExp>
      <RegExp input="$$6 [animenewsnetwork]" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)(?:(\[)|(\()|\*)(?(2)[^]]|(?(3)[^)]|[^*]))*$$9(?(2)[^]]|(?(3)[^)]|[^*]))*(?(2)\]|(?(3)\)|\*))</expression>
      </RegExp>
      <RegExp input="\n$$6\nfrom animenewsnetwork\n" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n[^\r\n]*$$7[: ]*$$9[^\r\n]*</expression>
      </RegExp>
      <RegExp input="\n$$6\nfrom http://\n" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n[^\r\n]*$$7[: ]*http://[^\r\n]*</expression>
      </RegExp>
      <RegExp input="\n$$6\nann summary\n" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n[^\r\n]*$$9[ ]*(?:summary|decription)[^\r\n]*</expression>
      </RegExp>
      <RegExp input="\n$$6\nhttp://\n" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n[ ]*http://[^\r\n ]*</expression>
      </RegExp>
      <RegExp input="\n$$6\nanimenfo\n" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n[ ]*$$9[ ]*</expression>
      </RegExp>
      <RegExp input="$$6 [i][/i]" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\[i][^\[]*\[/i]</expression>
      </RegExp>
      <RegExp input="\n$$6\ndescription by\n" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n(\*|-)?(\*|-)?[ ]*(?:(?:description|written) by)[^\r\n]*</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="6">
        <expression repeat="yes" noclean="1">(?i)(.*?)\r?\n[~-]\s+(?:translated and adapted|adapted and translated)[^\r\n]*cranston[^\r\n]*</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="6">
        <expression noclean="1">(?:\r?\n)*(.*)</expression>
      </RegExp>
      <RegExp input="$$6" output="'\1" dest="6">
        <expression repeat="yes" noclean="1">`?([^`]+)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="6">
        <expression noclean="1">'(.*)</expression>
      </RegExp>
      <RegExp input="$$6" output="&lt;plot&gt;\1&lt;/plot&gt;" dest="8">
        <expression clear="yes" noclean="1" trim="1"/>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="8">
        <expression noclean="1">(?i)(&lt;plot&gt;.*?&lt;/plot&gt;)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParsePlot>

  <GetCastByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseCast&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetCastByIDChain> 
  <ParseCast clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="6">
        <expression clear="yes" noclean="1">(?i)&lt;characters&gt;(.*?)&lt;/characters&gt;</expression>
      </RegExp>
      <RegExp input="$$6" output="&lt;actor&gt;&lt;name&gt;\3&lt;/name&gt;&lt;role&gt;\1&lt;/role&gt;&lt;thumb&gt;http://img7.anidb.net/pics/anime/\2&lt;/thumb&gt;&lt;/actor&gt;" dest="7">
        <expression clear="yes" repeat="yes">(?i)&lt;character.*?type=&quot;main character in&quot;[^&gt;]*&gt;.*?&lt;name&gt;([^&lt;]*)&lt;/name&gt;.*?&lt;seiyuu[^&gt;]*picture=&quot;([^&quot;]*)&quot;[^&gt;]*&gt;([^&lt;]*)&lt;/seiyuu&gt;.*?&lt;/character&gt;</expression>
      </RegExp>
      <RegExp input="$$6" output="&lt;actor&gt;&lt;name&gt;\2&lt;/name&gt;&lt;role&gt;\1&lt;/role&gt;&lt;/actor&gt;" dest="7+">
        <expression repeat="yes">(?i)&lt;character.*?type=&quot;main character in&quot;[^&gt;]*&gt;.*?&lt;name&gt;([^&lt;]*)&lt;/name&gt;.*?&lt;seiyuu[^&gt;]*&gt;([^&lt;]*)&lt;/seiyuu&gt;.*?&lt;/character&gt;</expression>
      </RegExp>
      <RegExp conditional="SecondAsMain" input="$$6" output="&lt;actor&gt;&lt;name&gt;\3&lt;/name&gt;&lt;role&gt;\1&lt;/role&gt;&lt;thumb&gt;http://img7.anidb.net/pics/anime/\2&lt;/thumb&gt;&lt;/actor&gt;" dest="7+">
        <expression repeat="yes">(?i)&lt;character.*?type=&quot;secondary cast in&quot;[^&gt;]*&gt;.*?&lt;name&gt;([^&lt;]*)&lt;/name&gt;.*?&lt;seiyuu[^&gt;]*picture=&quot;([^&quot;]*)&quot;[^&gt;]*&gt;([^&lt;]*)&lt;/seiyuu&gt;.*?&lt;/character&gt;</expression>
      </RegExp>
      <RegExp conditional="SecondAsMain" input="$$6" output="&lt;actor&gt;&lt;name&gt;\2&lt;/name&gt;&lt;role&gt;\1&lt;/role&gt;&lt;/actor&gt;" dest="7+">
        <expression repeat="yes">(?i)&lt;character.*?type=&quot;secondary cast in&quot;[^&gt;]*&gt;.*?&lt;name&gt;([^&lt;]*)&lt;/name&gt;.*?&lt;seiyuu[^&gt;]*&gt;([^&lt;]*)&lt;/seiyuu&gt;.*?&lt;/character&gt;</expression>
      </RegExp>
      <RegExp conditional="AppearsInAsMain" input="$$6" output="&lt;actor&gt;&lt;name&gt;\3&lt;/name&gt;&lt;role&gt;\1&lt;/role&gt;&lt;thumb&gt;http://img7.anidb.net/pics/anime/\2&lt;/thumb&gt;&lt;/actor&gt;" dest="7+">
        <expression repeat="yes">(?i)&lt;character.*?type=&quot;appears in&quot;[^&gt;]*&gt;.*?&lt;name&gt;([^&lt;]*)&lt;/name&gt;.*?&lt;seiyuu[^&gt;]*picture=&quot;([^&quot;]*)&quot;[^&gt;]*&gt;([^&lt;]*)&lt;/seiyuu&gt;.*?&lt;/character&gt;</expression>
      </RegExp>
      <RegExp conditional="AppearsInAsMain" input="$$6" output="&lt;actor&gt;&lt;name&gt;\2&lt;/name&gt;&lt;role&gt;\1&lt;/role&gt;&lt;/actor&gt;" dest="7+">
        <expression repeat="yes">(?i)&lt;character.*?type=&quot;appears in&quot;[^&gt;]*&gt;.*?&lt;name&gt;([^&lt;]*)&lt;/name&gt;.*?&lt;seiyuu[^&gt;]*&gt;([^&lt;]*)&lt;/seiyuu&gt;.*?&lt;/character&gt;</expression>
      </RegExp>
      <RegExp input="$$17" output="\1" dest="7+">
        <expression noclean="1" repeat="yes">(?i)(&lt;actor&gt;.*?&lt;/actor&gt;)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="7">
        <expression noclean="1" repeat="yes">(?i)(&lt;actor&gt;.*?&lt;/actor&gt;)</expression>
      </RegExp>
      <RegExp input="$$7" output="\1" dest="8">
        <RegExp input="$$7" output="'\1" dest="7">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
        </RegExp>
        <expression clear="yes" noclean="1">'(.*)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseCast>

  <GetWritersByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseWriters&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetWritersByIDChain> 
  <ParseWriters clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression clear="yes" noclean="1">(?i)&lt;creators&gt;(.*?)&lt;/creators&gt;</expression>
      </RegExp>
      <RegExp input="$$5" output="&lt;credits&gt;\1&lt;/credits&gt;" dest="6">
        <expression clear="yes" repeat="yes">(?i)&lt;name.*?type=&quot;(?:Original|Character)[^&gt;]*?&gt;(.*?)&lt;/name&gt;</expression>
      </RegExp>
      <RegExp input="$$17" output="\1" dest="6+">
        <expression noclean="1" repeat="yes">(?i)(&lt;credits&gt;.*?&lt;/credits&gt;)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1" repeat="yes">(?i)(&lt;credits&gt;.*?&lt;/credits&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8">
        <RegExp input="$$6" output="'\1" dest="6">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
        </RegExp>
        <expression clear="yes" noclean="1">'(.*)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseWriters>

  <GetDirectorsByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseDirectors&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetDirectorsByIDChain> 
  <ParseDirectors clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression clear="yes" noclean="1">(?i)&lt;creators&gt;(.*?)&lt;/creators&gt;</expression>
      </RegExp>
      <RegExp input="$$5" output="&lt;director&gt;\1&lt;/director&gt;" dest="6">
        <expression clear="yes" repeat="yes">(?i)&lt;name.*?type=&quot;Direction&quot;&gt;(.*?)&lt;/name&gt;</expression>
      </RegExp>
      <RegExp input="$$17" output="\1" dest="6+">
        <expression noclean="1" repeat="yes">(?i)(&lt;director&gt;.*?&lt;/director&gt;)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="6">
        <expression noclean="1" repeat="yes">(?i)(&lt;director&gt;.*?&lt;/director&gt;)</expression>
      </RegExp>
      <RegExp input="$$6" output="\1" dest="8">
        <RegExp input="$$6" output="'\1" dest="6">
          <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
        </RegExp>
        <expression clear="yes" noclean="1">'(.*)</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseDirectors>

  <GetStudiosByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseStudios&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetStudiosByIDChain> 
  <ParseStudios clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression clear="yes" noclean="1">(?i)&lt;creators&gt;(.*?)&lt;/creators&gt;</expression>
      </RegExp>
      <RegExp conditional="SingleStudio" input="$$7$$6$$10$$9" output="\1" dest="8">
        <!-- "Animation work" studios has priority over "Work" studios below ($$10,$$9) -->
        <RegExp input="$$5" output="&lt;studio&gt;\1&lt;/studio&gt;" dest="6">
          <expression clear="yes" repeat="yes">(?i)&lt;name.*?type=&quot;Animation Work&quot;&gt;([^&lt;]+)&lt;/name&gt;</expression>
        </RegExp>
        <RegExp input="$$17" output="\1" dest="6+">
          <expression noclean="1" repeat="yes">(?i)(&lt;studio&gt;.*?&lt;/studio&gt;)</expression>
        </RegExp>
        <RegExp input="$$18" output="\1" dest="6">
          <expression noclean="1" repeat="yes">(?i)(&lt;studio&gt;.*?&lt;/studio&gt;)</expression>
        </RegExp>
        <RegExp input="$$6" output="\1" dest="6">
          <RegExp input="$$6" output="'\1" dest="6">
            <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
          </RegExp>
          <expression clear="yes" noclean="1">'(.*)</expression>
        </RegExp>
        <!-- These studios have priority before rest below or non-enumerated ones ($$6) -->
        <RegExp input="$$6" output="\1" dest="7">
          <expression clear="yes" noclean="1">(?i)(&lt;studio&gt;(?=A-1 Pictures&lt;|AIC&lt;|Bee Train&lt;|Bones&lt;|Brain's Base&lt;|Gainax&lt;|Gonzo&lt;|J\.C\.Staff&lt;|Kyoto Animation&lt;|Madhouse&lt;|Manglobe&lt;|Nomad&lt;|Production I\.G&lt;|Shaft&lt;|Studio Deen&lt;|Studio Pierrot&lt;|Sunrise&lt;|Xebec&lt;|ZEXCS&lt;)[^&lt;]+&lt;/studio&gt;)</expression>
        </RegExp>
        <RegExp input="$$6" output="\1" dest="7+">
          <expression noclean="1">(?i)(&lt;studio&gt;(?=A-1 Pictures&lt;|ACGT&lt;|Actas&lt;|AIC A\.S\.T\.A&lt;|AIC Digital&lt;|AIC Plus\+&lt;|AIC Spirits&lt;|AIC&lt;|Ajia-dou&lt;|Animate Film&lt;|Anime Friend&lt;|Aquaplus&lt;|Arcturus&lt;|Arms&lt;|Artland&lt;|Artmic&lt;|Ashi Productions&lt;|Bee Train&lt;|Bones&lt;|Brain's Base&lt;|CoMix Wave Films&lt;|Daume&lt;|David Production&lt;|Diomedea&lt;|Doga Kobo&lt;|E&amp;G Films&lt;|G&amp;G Entertainment&lt;|G&amp;G Entertainmnt&lt;|Gainax&lt;|GK Entertainment&lt;|Gonzo&lt;|Group Tac&lt;|Hal Film Maker&lt;|Imagin&lt;|J\.C\.Staff&lt;|Karaku&lt;|Keyeast&lt;|Kyoto Animation&lt;|Madhouse&lt;|Manglobe&lt;|Nippon Animation&lt;|Nomad&lt;|OB Planning&lt;|OLM&lt;|Ordet&lt;|P\.A\. Works&lt;|Production I\.G&lt;|Radix Ace Entertainment&lt;|Radix&lt;|Satelight&lt;|Seven Arcs&lt;|Shaft&lt;|Studio 4C&lt;|Studio Barcelona&lt;|Studio Comet&lt;|Studio Deen&lt;|Studio Fantasia&lt;|Studio Ghibli&lt;|Studio Guts&lt;|Studio Hibari&lt;|Studio Izena&lt;|Studio Pierrot&lt;|Studio Rikka&lt;|Sunrise&lt;|Synergy Japan&lt;|SynergySP&lt;|Tatsunoko Production&lt;|Tezuka Productions&lt;|TMS Entertainment&lt;|Toei Animation&lt;|Toei Douga&lt;|Tokyo Movie&lt;|Trans Arts&lt;|Triangle Staff&lt;|Ufotable&lt;|White Fox&lt;|Xebec M2&lt;|Xebec&lt;|Yumeta Company&lt;|Zero G Room&lt;|ZEXCS&lt;)[^&lt;]+&lt;/studio&gt;)</expression>
        </RegExp>
        <!-- Same as above only for "Work" studios -->
        <RegExp input="$$5" output="&lt;studio&gt;\1&lt;/studio&gt;" dest="9">
          <expression clear="yes" repeat="yes">(?i)&lt;name.*?type=&quot;Work&quot;&gt;([^&lt;]+)&lt;/name&gt;</expression>
        </RegExp>
        <RegExp input="$$9" output="\1" dest="9">
          <RegExp input="$$9" output="'\1" dest="9">
            <expression clear="yes" repeat="yes" noclean="1">`?([^`]+)</expression>
          </RegExp>
          <expression clear="yes" noclean="1">'(.*)</expression>
        </RegExp>
        <RegExp input="$$9" output="\1" dest="10">
          <expression clear="yes" noclean="1">(?i)(&lt;studio&gt;(?=A-1 Pictures&lt;|AIC&lt;|Bee Train&lt;|Bones&lt;|Brain's Base&lt;|Gainax&lt;|Gonzo&lt;|J\.C\.Staff&lt;|Kyoto Animation&lt;|Madhouse&lt;|Manglobe&lt;|Nomad&lt;|Production I\.G&lt;|Shaft&lt;|Studio Deen&lt;|Studio Pierrot&lt;|Sunrise&lt;|Xebec&lt;|ZEXCS&lt;)[^&lt;]+&lt;/studio&gt;)</expression>
        </RegExp>
        <RegExp input="$$9" output="\1" dest="10+">
          <expression noclean="1">(?i)(&lt;studio&gt;(?=A-1 Pictures&lt;|ACGT&lt;|Actas&lt;|AIC A\.S\.T\.A&lt;|AIC Digital&lt;|AIC Plus\+&lt;|AIC Spirits&lt;|AIC&lt;|Ajia-dou&lt;|Animate Film&lt;|Anime Friend&lt;|Aquaplus&lt;|Arcturus&lt;|Arms&lt;|Artland&lt;|Artmic&lt;|Ashi Productions&lt;|Bee Train&lt;|Bones&lt;|Brain's Base&lt;|CoMix Wave Films&lt;|Daume&lt;|David Production&lt;|Diomedea&lt;|Doga Kobo&lt;|E&amp;G Films&lt;|G&amp;G Entertainment&lt;|G&amp;G Entertainmnt&lt;|Gainax&lt;|GK Entertainment&lt;|Gonzo&lt;|Group Tac&lt;|Hal Film Maker&lt;|Imagin&lt;|J\.C\.Staff&lt;|Karaku&lt;|Keyeast&lt;|Kyoto Animation&lt;|Madhouse&lt;|Manglobe&lt;|Nippon Animation&lt;|Nomad&lt;|OB Planning&lt;|OLM&lt;|Ordet&lt;|P\.A\. Works&lt;|Production I\.G&lt;|Radix Ace Entertainment&lt;|Radix&lt;|Satelight&lt;|Seven Arcs&lt;|Shaft&lt;|Studio 4C&lt;|Studio Barcelona&lt;|Studio Comet&lt;|Studio Deen&lt;|Studio Fantasia&lt;|Studio Ghibli&lt;|Studio Guts&lt;|Studio Hibari&lt;|Studio Izena&lt;|Studio Pierrot&lt;|Studio Rikka&lt;|Sunrise&lt;|Synergy Japan&lt;|SynergySP&lt;|Tatsunoko Production&lt;|Tezuka Productions&lt;|TMS Entertainment&lt;|Toei Animation&lt;|Toei Douga&lt;|Tokyo Movie&lt;|Trans Arts&lt;|Triangle Staff&lt;|Ufotable&lt;|White Fox&lt;|Xebec M2&lt;|Xebec&lt;|Yumeta Company&lt;|Zero G Room&lt;|ZEXCS&lt;)[^&lt;]+&lt;/studio&gt;)</expression>
        </RegExp>
        <!-- Only first studio is overtaken, order is result of joint $$7$$6$$10$$9 -->
        <expression clear="yes" noclean="1">(&lt;studio&gt;.+?&lt;/studio&gt;)</expression>
      </RegExp>
      <RegExp conditional="!SingleStudio" input="$$7" output="\1" dest="8">
        <!-- All studios found are overtaken -->
        <RegExp input="$$5" output="&lt;studio&gt;\1&lt;/studio&gt;" dest="7">
          <expression clear="yes" repeat="yes">(?i)&lt;name.*?type=&quot;Work&quot;&gt;([^&lt;]+)&lt;/name&gt;</expression>
        </RegExp>
        <!-- But "Animation Work" has priority and if there is any then "Work" studios are overwritten -->
        <RegExp input="$$5" output="&lt;studio&gt;\1&lt;/studio&gt;" dest="7">
          <expression repeat="yes">(?i)&lt;name.*?type=&quot;Animation Work&quot;&gt;([^&lt;]+)&lt;/name&gt;</expression>
        </RegExp>
        <RegExp input="$$17" output="\1" dest="7+">
          <expression noclean="1" repeat="yes">(?i)(&lt;studio&gt;.*?&lt;/studio&gt;)</expression>
        </RegExp>
        <RegExp input="$$18" output="\1" dest="7">
          <expression noclean="1" repeat="yes">(?i)(&lt;studio&gt;.*?&lt;/studio&gt;)</expression>
        </RegExp>
        <expression clear="yes" noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseStudios>

  <GetArtworkByIDChain clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="$$1" output="&lt;url function=&quot;ParseAniDBArtwork&quot; gzip=&quot;yes&quot; cache=&quot;\1.xml&quot;&gt;http://api.anidb.net:9001/httpapi?request=anime&amp;client=xbmcscrap&amp;clientver=1&amp;protover=1&amp;aid=\1&lt;/url&gt;" dest="8">
        <expression/>
      </RegExp>
      <RegExp input="$$12" output="&lt;url function=&quot;ParseTMDBArtwork&quot; cache=&quot;tmdb-images-$$1-\1.json&quot;&gt;http://api.themoviedb.org/3/movie/\1/images?api_key=57983e31fb435df4df77afb854740ea9&lt;/url&gt;" dest="8+">
        <expression repeat="yes">((?:tt)?\d+),?</expression>
      </RegExp>
      <RegExp input="$$19" output="&lt;url function=&quot;ParseTVDBArtwork&quot; cache=&quot;tvdb-$$1.xml&quot;&gt;http://www.thetvdb.com/api/1D62F2F90030C444/series/\1/all/en.zip&lt;/url&gt;" dest="8+">
        <expression>(\d+)</expression>
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;ReturnFanart&quot;&gt;&amp;&lt;/url&gt;" dest="8+">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </GetArtworkByIDChain>
  <ParseAniDBArtwork clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="&lt;thumb aspect=&quot;poster&quot;&gt;http://img7.anidb.net/pics/anime/\1&lt;/thumb&gt;" dest="8">
        <expression clear="yes">(?i)&lt;picture&gt;([^&lt;]+)&lt;/picture&gt;</expression>
      </RegExp>
      <RegExp input="$$17" output="\1" dest="8+">
        <expression noclean="1" repeat="yes">(?i)(&lt;thumb aspect=&quot;poster&quot;&gt;.*?&lt;/thumb&gt;)</expression>
      </RegExp>
      <RegExp input="$$18" output="\1" dest="8">
        <expression noclean="1" repeat="yes">(?i)(&lt;thumb aspect=&quot;poster&quot;&gt;.*?&lt;/thumb&gt;)</expression>
      </RegExp>
      <RegExp conditional="Fanarts" input="$$18" output="\1" dest="16">
        <expression noclean="1">(?i)&lt;fanart&gt;(.*)&lt;/fanart&gt;</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseAniDBArtwork>
  <ParseTMDBArtwork clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="7">
        <expression clear="yes" noclean="1">&quot;posters&quot;:\[{([^\]]*)</expression>
      </RegExp>
      <RegExp input="$$7" output="&lt;thumb aspect=&quot;poster&quot; preview=&quot;http://cf2.imgobject.com/t/p/w500\1&quot;&gt;http://cf2.imgobject.com/t/p/original\1&lt;/thumb&gt;" dest="8">
        <expression clear="yes" repeat="yes" noclean="1">&quot;file_path&quot;:&quot;([^&quot;]*)</expression>
      </RegExp>
      <RegExp conditional="Fanarts" input="$$9" output="\1" dest="16+">
        <RegExp input="$$1" output="\1" dest="7">
          <expression clear="yes" noclean="1">&quot;backdrops&quot;:\[{([^\]]*)</expression>
        </RegExp>
        <RegExp input="$$7" output="&lt;thumb preview=&quot;http://cf2.imgobject.com/t/p/w780\1&quot;&gt;http://cf2.imgobject.com/t/p/original\1&lt;/thumb&gt;" dest="9">
          <expression clear="yes" repeat="yes" noclean="1">&quot;file_path&quot;:&quot;([^&quot;]*)</expression>
        </RegExp>
        <expression noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseTMDBArtwork>
  <ParseTVDBArtwork clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$1" output="\1" dest="5">
        <expression clear="yes" noclean="1">(?i)&lt;Banners&gt;(.*?)&lt;/Banners&gt;</expression>
      </RegExp>
      <RegExp conditional="Fanarts" input="$$6" output="\1" dest="16+">
        <RegExp input="$$5" output="&lt;thumb dim=&quot;\2&quot; colors=&quot;\3&quot; preview=&quot;http://thetvdb.com/banners/_cache/\1&quot;&gt;http://thetvdb.com/banners/\1&lt;/thumb&gt;" dest="6">
          <expression clear="yes" repeat="yes">(?i)&lt;BannerPath&gt;([^&lt;]*)&lt;/BannerPath&gt;[^&lt;]*&lt;BannerType&gt;fanart&lt;/BannerType&gt;[^&lt;]*&lt;BannerType2&gt;([^&lt;]*)&lt;/BannerType2&gt;[^&lt;]*&lt;Colors&gt;([^&lt;]*)&lt;/Colors&gt;</expression>
        </RegExp>
        <expression noclean="1">(.+)</expression>
      </RegExp>
      <RegExp input="$$5" output="&lt;thumb aspect=&quot;poster&quot;&gt;http://thetvdb.com/banners/\1&lt;/thumb&gt;" dest="8">
        <expression clear="yes" repeat="yes">(?i)&lt;BannerPath&gt;([^&lt;]*)&lt;/BannerPath&gt;[^&lt;]*&lt;BannerType&gt;poster&lt;/BannerType&gt;</expression>
      </RegExp>
      <RegExp input="$$5" output="&lt;thumb aspect=&quot;poster&quot;&gt;http://thetvdb.com/banners/\1&lt;/thumb&gt;" dest="8+">
        <expression repeat="yes">(?i)&lt;BannerPath&gt;([^&lt;]*)&lt;/BannerPath&gt;[^&lt;]*&lt;BannerType&gt;season&lt;/BannerType&gt;[^&lt;]*&lt;BannerType2&gt;season&lt;/BannerType2&gt;</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ParseTVDBArtwork>
  <ReturnFanart clearbuffers="no" dest="4">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$16" output="&lt;fanart&gt;\1&lt;fanart&gt;" dest="8">
        <expression clear="yes" noclean="1"/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </ReturnFanart>

  <StartDelayLoop clearbuffers="no" dest="3">
    <RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
      <RegExp input="" output="`X" dest="11">
        <expression/> 
      </RegExp>
      <RegExp input="" output="&lt;chain function=&quot;DelayLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="8">
        <expression/>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </StartDelayLoop>  
  <DelayLoop clearbuffers="no" dest="4">
    <RegExp input="$$4" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
      <RegExp input="$$11" output="&lt;chain function=&quot;DelayLoop&quot;&gt;&amp;&lt;/chain&gt;" dest="4">
        <RegExp input="$$10" output="\1" dest="11">
          <RegExp input="$$11" output="\1`X" dest="10">
            <expression>^((?:`(?!.*Z)){1,$INFO[DelayValue]}?)X$</expression> 
          </RegExp> 
          <RegExp input="$$11" output="\1Y" dest="10">
            <expression>^((?:`(?!.*Z)){$INFO[DelayValue]})`X$</expression> 
          </RegExp> 
          <RegExp input="$$11" output="\1Y" dest="10">
            <expression>^((?:`(?!.*Z)){1,$INFO[DelayValue]}?)`Y$</expression> 
          </RegExp> 
          <expression/>
        </RegExp>
        <expression clear="yes">``+</expression>
      </RegExp>
      <expression noclean="1"/>
    </RegExp>
  </DelayLoop>
  
</scraperfunctions>